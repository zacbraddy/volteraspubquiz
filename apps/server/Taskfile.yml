version: '3'

vars:
  GREETING: Hello, World!

tasks:
  bootstrap:
    cmds:
      - poetry env use python3.11
      - pip install --upgrade pip setuptools wheel
      - poetry install

  dev:
    cmds:
      - poetry env use python3.11
      - PYTHONPATH=$PYTHONPATH:$(pwd)/src poetry run fastapi dev src/main.py

  lint:
    cmds:
      - poetry env use python3.11
      - poetry run isort ./**/*.py
      - poetry run black ./**/*.py
      - poetry run flake8 ./**/*.py

  test:
    cmds:
      - poetry env use python3.11
      - PYTHONPATH=$PYTHONPATH:$(pwd)/src poetry run pytest tests/ -v
